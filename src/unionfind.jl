module unionfind
using BenchmarkTools

    function find(Parent, i)
        if Parent[i] != i 
            Parent[i] = find(Parent ,Parent[i])
        end
        return Parent[i]
    end

    function union(Parent, rank , x, y)
        s1 = find(Parent, x)
        s2 = find(Parent, y)

        if s1 != s2
            if rank[s1] < rank[s2]
                Parent[s1] = s2
            elseif rank[s1] > rank[s2]
                Parent[s2] = s1
            else
                Parent[s2] = s1
                rank[s1] += 1
            end
        end
        return Parent, rank
    end

    function DSU(n)
        Parent = collect(1:n)
        rank = ones(Int,n)
        return Parent, rank
    end



    function kruskals_mst(V,E)
        Parent, rank = DSU(length(V))
        count = 0 
        cost = 0
        for e in E
            x = e[1]
            y = e[2]

            if find(Parent, x) != find(Parent, y)
                Parent, rank = union(Parent, rank, x,y)
                count += 1
                cost += 1
                if count  == length(V) - 1
                    break 
                end
            end
        end
        return Parent
    end

    function connectedComponents(V,E)
        return length(unique(kruskals_mst(V,E)))
    end
# 3-D Torus Example
V3DT = Any[1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125]
E3DT = Any[(1, 1), (1, 2), (1, 5), (1, 6), (1, 21), (1, 26), (1, 101), (2, 1), (2, 2), (2, 3), (2, 7), (2, 22), (2, 27), (2, 102), (3, 2), (3, 3), (3, 4), (3, 8), (3, 23), (3, 28), (3, 103), (4, 3), (4, 4), (4, 5), (4, 9), (4, 24), (4, 29), (4, 104), (5, 1), (5, 4), (5, 5), (5, 10), (5, 25), (5, 30), (5, 105), (6, 1), (6, 6), (6, 7), (6, 10), (6, 11), (6, 31), (6, 106), (7, 2), (7, 6), (7, 7), (7, 8), (7, 12), (7, 32), (7, 107), (8, 3), (8, 7), (8, 8), (8, 9), (8, 13), (8, 33), (8, 108), (9, 4), (9, 8), (9, 9), (9, 10), (9, 14), (9, 34), (9, 109), (10, 5), (10, 6), (10, 9), (10, 10), (10, 15), (10, 35), (10, 110), (11, 6), (11, 11), (11, 12), (11, 15), (11, 16), (11, 36), (11, 111), (12, 7), (12, 11), (12, 12), (12, 13), (12, 17), (12, 37), (12, 112), (13, 8), (13, 12), (13, 13), (13, 14), (13, 18), (13, 38), (13, 113), (14, 9), (14, 13), (14, 14), (14, 15), (14, 19), (14, 39), (14, 114), (15, 10), (15, 11), (15, 14), (15, 15), (15, 20), (15, 40), (15, 115), (16, 11), (16, 16), (16, 17), (16, 20), (16, 21), (16, 41), (16, 116), (17, 12), (17, 16), (17, 17), (17, 18), (17, 22), (17, 42), (17, 117), (18, 13), (18, 17), (18, 18), (18, 19), (18, 23), (18, 43), (18, 118), (19, 14), (19, 18), (19, 19), (19, 20), (19, 24), (19, 44), (19, 119), (20, 15), (20, 16), (20, 19), (20, 20), (20, 25), (20, 45), (20, 120), (21, 1), (21, 16), (21, 21), (21, 22), (21, 25), (21, 46), (21, 121), (22, 2), (22, 17), (22, 21), (22, 22), (22, 23), (22, 47), (22, 122), (23, 3), (23, 18), (23, 22), (23, 23), (23, 24), (23, 48), (23, 123), (24, 4), (24, 19), (24, 23), (24, 24), (24, 25), (24, 49), (24, 124), (25, 5), (25, 20), (25, 21), (25, 24), (25, 25), (25, 50), (25, 125), (26, 1), (26, 26), (26, 27), (26, 30), (26, 31), (26, 46), (26, 51), (27, 2), (27, 26), (27, 27), (27, 28), (27, 32), (27, 47), (27, 52), (28, 3), (28, 27), (28, 28), (28, 29), (28, 33), (28, 48), (28, 53), (29, 4), (29, 28), (29, 29), (29, 30), (29, 34), (29, 49), (29, 54), (30, 5), (30, 26), (30, 29), (30, 30), (30, 35), (30, 50), (30, 55), (31, 6), (31, 26), (31, 31), (31, 32), (31, 35), (31, 36), (31, 56), (32, 7), (32, 27), (32, 31), (32, 32), (32, 33), (32, 37), (32, 57), (33, 8), (33, 28), (33, 32), (33, 33), (33, 34), (33, 38), (33, 58), (34, 9), (34, 29), (34, 33), (34, 34), (34, 35), (34, 39), (34, 59), (35, 10), (35, 30), (35, 31), (35, 34), (35, 35), (35, 40), (35, 60), (36, 11), (36, 31), (36, 36), (36, 37), (36, 40), (36, 41), (36, 61), (37, 12), (37, 32), (37, 36), (37, 37), (37, 38), (37, 42), (37, 62), (38, 13), (38, 33), (38, 37), (38, 38), (38, 39), (38, 43), (38, 63), (39, 14), (39, 34), (39, 38), (39, 39), (39, 40), (39, 44), (39, 64), (40, 15), (40, 35), (40, 36), (40, 39), (40, 40), (40, 45), (40, 65), (41, 16), (41, 36), (41, 41), (41, 42), (41, 45), (41, 46), (41, 66), (42, 17), (42, 37), (42, 41), (42, 42), (42, 43), (42, 47), (42, 67), (43, 18), (43, 38), (43, 42), (43, 43), (43, 44), (43, 48), (43, 68), (44, 19), (44, 39), (44, 43), (44, 44), (44, 45), (44, 49), (44, 69), (45, 20), (45, 40), (45, 41), (45, 44), (45, 45), (45, 50), (45, 70), (46, 21), (46, 26), (46, 41), (46, 46), (46, 47), (46, 50), (46, 71), (47, 22), (47, 27), (47, 42), (47, 46), (47, 47), (47, 48), (47, 72), (48, 23), (48, 28), (48, 43), (48, 47), (48, 48), (48, 49), (48, 73), (49, 24), (49, 29), (49, 44), (49, 48), (49, 49), (49, 50), (49, 74), (50, 25), (50, 30), (50, 45), (50, 46), (50, 49), (50, 50), (50, 75), (51, 26), (51, 51), (51, 52), (51, 55), (51, 56), (51, 71), (51, 76), (52, 27), (52, 51), (52, 52), (52, 53), (52, 57), (52, 72), (52, 77), (53, 28), (53, 52), (53, 53), (53, 54), (53, 58), (53, 73), (53, 78), (54, 29), (54, 53), (54, 54), (54, 55), (54, 59), (54, 74), (54, 79), (55, 30), (55, 51), (55, 54), (55, 55), (55, 60), (55, 75), (55, 80), (56, 31), (56, 51), (56, 56), (56, 57), (56, 60), (56, 61), (56, 81), (57, 32), (57, 52), (57, 56), (57, 57), (57, 58), (57, 62), (57, 82), (58, 33), (58, 53), (58, 57), (58, 58), (58, 59), (58, 63), (58, 83), (59, 34), (59, 54), (59, 58), (59, 59), (59, 60), (59, 64), (59, 84), (60, 35), (60, 55), (60, 56), (60, 59), (60, 60), (60, 65), (60, 85), (61, 36), (61, 56), (61, 61), (61, 62), (61, 65), (61, 66), (61, 86), (62, 37), (62, 57), (62, 61), (62, 62), (62, 63), (62, 67), (62, 87), (63, 38), (63, 58), (63, 62), (63, 63), (63, 64), (63, 68), (63, 88), (64, 39), (64, 59), (64, 63), (64, 64), (64, 65), (64, 69), (64, 89), (65, 40), (65, 60), (65, 61), (65, 64), (65, 65), (65, 70), (65, 90), (66, 41), (66, 61), (66, 66), (66, 67), (66, 70), (66, 71), (66, 91), (67, 42), (67, 62), (67, 66), (67, 67), (67, 68), (67, 72), (67, 92), (68, 43), (68, 63), (68, 67), (68, 68), (68, 69), (68, 73), (68, 93), (69, 44), (69, 64), (69, 68), (69, 69), (69, 70), (69, 74), (69, 94), (70, 45), (70, 65), (70, 66), (70, 69), (70, 70), (70, 75), (70, 95), (71, 46), (71, 51), (71, 66), (71, 71), (71, 72), (71, 75), (71, 96), (72, 47), (72, 52), (72, 67), (72, 71), (72, 72), (72, 73), (72, 97), (73, 48), (73, 53), (73, 68), (73, 72), (73, 73), (73, 74), (73, 98), (74, 49), (74, 54), (74, 69), (74, 73), (74, 74), (74, 75), (74, 99), (75, 50), (75, 55), (75, 70), (75, 71), (75, 74), (75, 75), (75, 100), (76, 51), (76, 76), (76, 77), (76, 80), (76, 81), (76, 96), (76, 101), (77, 52), (77, 76), (77, 77), (77, 78), (77, 82), (77, 97), (77, 102), (78, 53), (78, 77), (78, 78), (78, 79), (78, 83), (78, 98), (78, 103), (79, 54), (79, 78), (79, 79), (79, 80), (79, 84), (79, 99), (79, 104), (80, 55), (80, 76), (80, 79), (80, 80), (80, 85), (80, 100), (80, 105), (81, 56), (81, 76), (81, 81), (81, 82), (81, 85), (81, 86), (81, 106), (82, 57), (82, 77), (82, 81), (82, 82), (82, 83), (82, 87), (82, 107), (83, 58), (83, 78), (83, 82), (83, 83), (83, 84), (83, 88), (83, 108), (84, 59), (84, 79), (84, 83), (84, 84), (84, 85), (84, 89), (84, 109), (85, 60), (85, 80), (85, 81), (85, 84), (85, 85), (85, 90), (85, 110), (86, 61), (86, 81), (86, 86), (86, 87), (86, 90), (86, 91), (86, 111), (87, 62), (87, 82), (87, 86), (87, 87), (87, 88), (87, 92), (87, 112), (88, 63), (88, 83), (88, 87), (88, 88), (88, 89), (88, 93), (88, 113), (89, 64), (89, 84), (89, 88), (89, 89), (89, 90), (89, 94), (89, 114), (90, 65), (90, 85), (90, 86), (90, 89), (90, 90), (90, 95), (90, 115), (91, 66), (91, 86), (91, 91), (91, 92), (91, 95), (91, 96), (91, 116), (92, 67), (92, 87), (92, 91), (92, 92), (92, 93), (92, 97), (92, 117), (93, 68), (93, 88), (93, 92), (93, 93), (93, 94), (93, 98), (93, 118), (94, 69), (94, 89), (94, 93), (94, 94), (94, 95), (94, 99), (94, 119), (95, 70), (95, 90), (95, 91), (95, 94), (95, 95), (95, 100), (95, 120), (96, 71), (96, 76), (96, 91), (96, 96), (96, 97), (96, 100), (96, 121), (97, 72), (97, 77), (97, 92), (97, 96), (97, 97), (97, 98), (97, 122), (98, 73), (98, 78), (98, 93), (98, 97), (98, 98), (98, 99), (98, 123), (99, 74), (99, 79), (99, 94), (99, 98), (99, 99), (99, 100), (99, 124), (100, 75), (100, 80), (100, 95), (100, 96), (100, 99), (100, 100), (100, 125), (101, 1), (101, 76), (101, 101), (101, 102), (101, 105), (101, 106), (101, 121), (102, 2), (102, 77), (102, 101), (102, 102), (102, 103), (102, 107), (102, 122), (103, 3), (103, 78), (103, 102), (103, 103), (103, 104), (103, 108), (103, 123), (104, 4), (104, 79), (104, 103), (104, 104), (104, 105), (104, 109), (104, 124), (105, 5), (105, 80), (105, 101), (105, 104), (105, 105), (105, 110), (105, 125), (106, 6), (106, 81), (106, 101), (106, 106), (106, 107), (106, 110), (106, 111), (107, 7), (107, 82), (107, 102), (107, 106), (107, 107), (107, 108), (107, 112), (108, 8), (108, 83), (108, 103), (108, 107), (108, 108), (108, 109), (108, 113), (109, 9), (109, 84), (109, 104), (109, 108), (109, 109), (109, 110), (109, 114), (110, 10), (110, 85), (110, 105), (110, 106), (110, 109), (110, 110), (110, 115), (111, 11), (111, 86), (111, 106), (111, 111), (111, 112), (111, 115), (111, 116), (112, 12), (112, 87), (112, 107), (112, 111), (112, 112), (112, 113), (112, 117), (113, 13), (113, 88), (113, 108), (113, 112), (113, 113), (113, 114), (113, 118), (114, 14), (114, 89), (114, 109), (114, 113), (114, 114), (114, 115), (114, 119), (115, 15), (115, 90), (115, 110), (115, 111), (115, 114), (115, 115), (115, 120), (116, 16), (116, 91), (116, 111), (116, 116), (116, 117), (116, 120), (116, 121), (117, 17), (117, 92), (117, 112), (117, 116), (117, 117), (117, 118), (117, 122), (118, 18), (118, 93), (118, 113), (118, 117), (118, 118), (118, 119), (118, 123), (119, 19), (119, 94), (119, 114), (119, 118), (119, 119), (119, 120), (119, 124), (120, 20), (120, 95), (120, 115), (120, 116), (120, 119), (120, 120), (120, 125), (121, 21), (121, 96), (121, 101), (121, 116), (121, 121), (121, 122), (121, 125), (122, 22), (122, 97), (122, 102), (122, 117), (122, 121), (122, 122), (122, 123), (123, 23), (123, 98), (123, 103), (123, 118), (123, 122), (123, 123), (123, 124), (124, 24), (124, 99), (124, 104), (124, 119), (124, 123), (124, 124), (124, 125), (125, 25), (125, 100), (125, 105), (125, 120), (125, 121), (125, 124), (125, 125)]

E23DT = []
for e in E3DT 
    if !(e[1] == e[2])
        push!(E23DT, [e[1], e[2]])
    end
end
end